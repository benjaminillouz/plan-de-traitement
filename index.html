<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hello PdT - Plan de Traitement</title>
    <meta name="description" content="Application de plan de traitement dentaire interactive pour les professionnels">
    <meta name="keywords" content="plan de traitement, dentaire, proth√®se, implant, endodontie, parodontologie">
    <meta name="author" content="Hello PdT">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="assets/tooth.svg">

    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: '#e6f2f5',
                            100: '#cce5eb',
                            200: '#99ccd7',
                            300: '#66b2c3',
                            400: '#3399af',
                            500: '#004B63',
                            600: '#003d51',
                            700: '#002f3f',
                            800: '#00212d',
                            900: '#00131b',
                        },
                        dental: {
                            avulsion: '#ef4444',
                            restauration: '#22c55e',
                            endo: '#15803d',
                            implant: '#3b82f6',
                            transitoire: '#eab308',
                            definitive: '#0f766e',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Scrollbar personnalis√©e */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Animation fadeIn */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out;
        }

        /* Styles d'impression */
        @media print {
            .no-print {
                display: none !important;
            }
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }

        /* Dental chart tooth styles */
        .tooth {
            transition: all 0.15s ease;
        }
        .tooth:hover {
            transform: scale(1.15);
            z-index: 10;
        }
        .tooth.selected-avulsion { background-color: #ef4444; color: white; border-color: #dc2626; }
        .tooth.selected-restauration { background-color: #22c55e; color: white; border-color: #16a34a; }
        .tooth.selected-endo { background-color: #15803d; color: white; border-color: #166534; }
        .tooth.selected-implant { background-color: #3b82f6; color: white; border-color: #2563eb; }
        .tooth.selected-parodonto { background-color: #8b5cf6; color: white; border-color: #7c3aed; }
        .tooth.selected-transitoire { background-color: #eab308; color: #1f2937; border-color: #ca8a04; }
        .tooth.selected-definitive { background-color: #0f766e; color: white; border-color: #0d9488; }
    </style>
</head>
<body class="bg-slate-50 font-sans antialiased min-h-screen">

    <!-- Header -->
    <header class="bg-gradient-to-r from-primary-500 to-primary-600 sticky top-0 z-50 no-print shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-white/20 backdrop-blur rounded-xl flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C9.5 2 7.5 3.5 7 5.5C6.5 7.5 7 9 7 11C7 13 6 15 5.5 17C5 19 5.5 21 7.5 22C9.5 23 10 21 10.5 19C11 17 11.5 15 12 15C12.5 15 13 17 13.5 19C14 21 14.5 23 16.5 22C18.5 21 19 19 18.5 17C18 15 17 13 17 11C17 9 17.5 7.5 17 5.5C16.5 3.5 14.5 2 12 2Z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-white">Hello <span class="text-primary-100">PdT</span></h1>
                        <p class="text-xs text-primary-200 -mt-0.5">Plan de Traitement</p>
                    </div>
                </div>

                <!-- Patient Info -->
                <div id="patient-info" class="hidden items-center gap-4">
                    <div class="text-right">
                        <p id="display-patient-name" class="text-sm font-semibold text-white"></p>
                        <p id="display-practitioner-name" class="text-xs text-primary-200"></p>
                    </div>
                    <div id="display-center-name" class="px-3 py-1.5 bg-white/20 backdrop-blur text-white text-xs font-medium rounded-full"></div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- Treatment Sections Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

            <!-- 1. Assainissement -->
            <section class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden animate-fadeIn">
                <div class="px-6 py-4 border-b border-slate-100 bg-gradient-to-r from-slate-50 to-white">
                    <div class="flex items-center gap-3">
                        <span class="w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center text-lg">üßΩ</span>
                        <h2 class="text-lg font-semibold text-slate-900">1. Assainissement</h2>
                    </div>
                </div>
                <div class="p-6 space-y-4">
                    <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 cursor-pointer transition-colors group">
                        <input type="checkbox" id="detartrage" class="w-5 h-5 rounded border-slate-300 text-primary-600 focus:ring-primary-500 focus:ring-offset-0">
                        <span class="text-slate-700 group-hover:text-slate-900">D√©tartrage</span>
                    </label>

                    <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 cursor-pointer transition-colors group">
                        <input type="checkbox" id="avulsion" onchange="toggleDentalChart(this, 'avulsion-chart')" class="w-5 h-5 rounded border-slate-300 text-red-600 focus:ring-red-500 focus:ring-offset-0">
                        <span class="text-slate-700 group-hover:text-slate-900">Avulsions dentaires</span>
                    </label>
                    <div id="avulsion-chart" class="dental-chart hidden" data-type="avulsion"></div>
                </div>
            </section>

            <!-- 2. Soins conservateurs -->
            <section class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden animate-fadeIn" style="animation-delay: 0.05s">
                <div class="px-6 py-4 border-b border-slate-100 bg-gradient-to-r from-slate-50 to-white">
                    <div class="flex items-center gap-3">
                        <span class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center text-lg">ü™•</span>
                        <h2 class="text-lg font-semibold text-slate-900">2. Soins conservateurs</h2>
                    </div>
                </div>
                <div class="p-6 space-y-4">
                    <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 cursor-pointer transition-colors group">
                        <input type="checkbox" id="restauration" onchange="toggleDentalChart(this, 'restauration-chart')" class="w-5 h-5 rounded border-slate-300 text-green-600 focus:ring-green-500 focus:ring-offset-0">
                        <span class="text-slate-700 group-hover:text-slate-900">Restaurations</span>
                    </label>
                    <div id="restauration-chart" class="dental-chart hidden" data-type="restauration"></div>

                    <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 cursor-pointer transition-colors group">
                        <input type="checkbox" id="endo" onchange="toggleDentalChart(this, 'endo-chart')" class="w-5 h-5 rounded border-slate-300 text-emerald-700 focus:ring-emerald-600 focus:ring-offset-0">
                        <span class="text-slate-700 group-hover:text-slate-900">Traitements endodontiques</span>
                    </label>
                    <div id="endo-chart" class="dental-chart hidden" data-type="endo"></div>
                </div>
            </section>

            <!-- 3. Soins compl√©mentaires -->
            <section class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden animate-fadeIn" style="animation-delay: 0.1s">
                <div class="px-6 py-4 border-b border-slate-100 bg-gradient-to-r from-slate-50 to-white">
                    <div class="flex items-center gap-3">
                        <span class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-lg">üîß</span>
                        <h2 class="text-lg font-semibold text-slate-900">3. Soins compl√©mentaires</h2>
                    </div>
                </div>
                <div class="p-6 space-y-4">
                    <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 cursor-pointer transition-colors group">
                        <input type="checkbox" id="implant" onchange="toggleDentalChart(this, 'implant-chart')" class="w-5 h-5 rounded border-slate-300 text-blue-600 focus:ring-blue-500 focus:ring-offset-0">
                        <span class="text-slate-700 group-hover:text-slate-900">Pose d'implants</span>
                    </label>
                    <div id="implant-chart" class="dental-chart hidden" data-type="implant"></div>

                    <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 cursor-pointer transition-colors group">
                        <input type="checkbox" id="parodonto" onchange="toggleDentalChart(this, 'parodonto-chart')" class="w-5 h-5 rounded border-slate-300 text-violet-600 focus:ring-violet-500 focus:ring-offset-0">
                        <span class="text-slate-700 group-hover:text-slate-900">Parodontologie</span>
                    </label>
                    <div id="parodonto-chart" class="dental-chart hidden" data-type="parodonto"></div>
                </div>
            </section>

            <!-- 4. Proth√®ses transitoires -->
            <section class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden animate-fadeIn" style="animation-delay: 0.15s">
                <div class="px-6 py-4 border-b border-slate-100 bg-gradient-to-r from-slate-50 to-white">
                    <div class="flex items-center gap-3">
                        <span class="w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center text-lg">ü¶∑</span>
                        <h2 class="text-lg font-semibold text-slate-900">4. Proth√®ses transitoires</h2>
                    </div>
                </div>
                <div class="p-6 space-y-4">
                    <div class="flex gap-4">
                        <label class="flex items-center gap-2 px-4 py-2 rounded-xl border-2 border-slate-200 hover:border-primary-300 cursor-pointer transition-colors has-[:checked]:border-primary-500 has-[:checked]:bg-primary-50">
                            <input type="radio" name="transitoires" value="oui" onclick="toggleDentalChartRadio('transitoire-chart', true)" class="w-4 h-4 text-primary-600 focus:ring-primary-500">
                            <span class="text-slate-700 font-medium">Oui</span>
                        </label>
                        <label class="flex items-center gap-2 px-4 py-2 rounded-xl border-2 border-slate-200 hover:border-slate-300 cursor-pointer transition-colors has-[:checked]:border-slate-400 has-[:checked]:bg-slate-50">
                            <input type="radio" name="transitoires" value="non" onclick="toggleDentalChartRadio('transitoire-chart', false)" class="w-4 h-4 text-slate-600 focus:ring-slate-500">
                            <span class="text-slate-700 font-medium">Non</span>
                        </label>
                    </div>
                    <div id="transitoire-chart" class="dental-chart hidden" data-type="transitoire"></div>
                </div>
            </section>

            <!-- 5. Proth√®ses d√©finitives -->
            <section class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden md:col-span-2 animate-fadeIn" style="animation-delay: 0.2s">
                <div class="px-6 py-4 border-b border-slate-100 bg-gradient-to-r from-slate-50 to-white">
                    <div class="flex items-center gap-3">
                        <span class="w-8 h-8 bg-teal-100 rounded-lg flex items-center justify-center text-lg">üëë</span>
                        <h2 class="text-lg font-semibold text-slate-900">5. Proth√®ses d√©finitives</h2>
                    </div>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="space-y-4">
                            <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 cursor-pointer transition-colors group">
                                <input type="checkbox" id="inlay-core" onchange="toggleDentalChart(this, 'inlay-chart')" class="w-5 h-5 rounded border-slate-300 text-teal-600 focus:ring-teal-500 focus:ring-offset-0">
                                <span class="text-slate-700 group-hover:text-slate-900">Inlay Core</span>
                            </label>
                            <div id="inlay-chart" class="dental-chart hidden" data-type="definitive"></div>

                            <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 cursor-pointer transition-colors group">
                                <input type="checkbox" id="couronne" onchange="toggleDentalChart(this, 'couronne-chart')" class="w-5 h-5 rounded border-slate-300 text-teal-600 focus:ring-teal-500 focus:ring-offset-0">
                                <span class="text-slate-700 group-hover:text-slate-900">Couronnes</span>
                            </label>
                            <div id="couronne-chart" class="dental-chart hidden" data-type="definitive"></div>
                        </div>
                        <div class="space-y-4">
                            <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 cursor-pointer transition-colors group">
                                <input type="checkbox" id="onlay" onchange="toggleDentalChart(this, 'onlay-chart')" class="w-5 h-5 rounded border-slate-300 text-teal-600 focus:ring-teal-500 focus:ring-offset-0">
                                <span class="text-slate-700 group-hover:text-slate-900">Inlay / Onlay</span>
                            </label>
                            <div id="onlay-chart" class="dental-chart hidden" data-type="definitive"></div>

                            <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 cursor-pointer transition-colors group">
                                <input type="checkbox" id="prothese-amovible" onchange="toggleDentalChart(this, 'prothese-chart')" class="w-5 h-5 rounded border-slate-300 text-teal-600 focus:ring-teal-500 focus:ring-offset-0">
                                <span class="text-slate-700 group-hover:text-slate-900">Proth√®ses amovibles</span>
                            </label>
                            <div id="prothese-chart" class="dental-chart hidden" data-type="definitive"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 6. Radiographies -->
            <section class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden animate-fadeIn" style="animation-delay: 0.25s">
                <div class="px-6 py-4 border-b border-slate-100 bg-gradient-to-r from-slate-50 to-white">
                    <div class="flex items-center gap-3">
                        <span class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center text-lg">ü©ª</span>
                        <h2 class="text-lg font-semibold text-slate-900">6. Radiographies</h2>
                    </div>
                </div>
                <div class="p-6 space-y-4">
                    <button id="captureScreen" class="w-full flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-primary-500 to-primary-600 text-white font-medium rounded-xl shadow-lg shadow-primary-500/20 hover:shadow-xl hover:shadow-primary-500/30 hover:-translate-y-0.5 transition-all">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                        Capturer l'√©cran
                    </button>
                    <div id="previewContainer" class="hidden">
                        <p class="text-sm text-slate-500 mb-2">Pr√©visualisation :</p>
                        <div class="relative group">
                            <img id="screenshotPreview" src="" alt="Capture d'√©cran" class="w-full rounded-xl border border-slate-200 shadow-sm">
                            <button id="removeScreenshot" class="absolute -top-2 -right-2 w-7 h-7 bg-red-500 text-white rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center hover:bg-red-600">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <input type="hidden" id="screenshotData">
                </div>
            </section>

            <!-- 7. Pi√®ces jointes -->
            <section class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden animate-fadeIn" style="animation-delay: 0.3s">
                <div class="px-6 py-4 border-b border-slate-100 bg-gradient-to-r from-slate-50 to-white">
                    <div class="flex items-center gap-3">
                        <span class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center text-lg">üìé</span>
                        <h2 class="text-lg font-semibold text-slate-900">7. Pi√®ces jointes</h2>
                    </div>
                </div>
                <div class="p-6 space-y-4">
                    <label for="fileUpload" class="flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed border-slate-300 rounded-xl text-slate-600 font-medium hover:border-primary-400 hover:text-primary-600 hover:bg-primary-50/50 cursor-pointer transition-all">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                        </svg>
                        Ajouter des fichiers
                    </label>
                    <input type="file" id="fileUpload" multiple accept="image/*,.pdf,.doc,.docx" class="hidden">
                    <div id="fileList" class="space-y-2"></div>
                </div>
            </section>

            <!-- 8. Notes -->
            <section class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden md:col-span-2 animate-fadeIn" style="animation-delay: 0.35s">
                <div class="px-6 py-4 border-b border-slate-100 bg-gradient-to-r from-slate-50 to-white">
                    <div class="flex items-center gap-3">
                        <span class="w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center text-lg">üìù</span>
                        <h2 class="text-lg font-semibold text-slate-900">8. Notes compl√©mentaires</h2>
                    </div>
                </div>
                <div class="p-6">
                    <textarea id="notes" rows="4" placeholder="Ajoutez des notes ou observations compl√©mentaires..." class="w-full px-4 py-3 border border-slate-200 rounded-xl text-slate-700 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none transition-shadow"></textarea>
                </div>
            </section>
        </div>

        <!-- Save Button -->
        <div class="flex justify-center mt-8 no-print">
            <button id="savePlanButton" class="group flex items-center gap-3 px-8 py-4 bg-gradient-to-r from-primary-500 via-primary-600 to-primary-700 text-white text-lg font-semibold rounded-2xl shadow-xl shadow-primary-500/30 hover:shadow-2xl hover:shadow-primary-500/40 hover:-translate-y-1 transition-all">
                <svg class="w-6 h-6 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/>
                </svg>
                Enregistrer le Plan de Traitement
            </button>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-primary-500 to-primary-600 mt-12 no-print">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-2 text-primary-100 text-sm">
                    <span>¬© 2024</span>
                    <span class="font-semibold text-white">Hello PdT</span>
                    <span>- Plan de Traitement Dentaire</span>
                </div>
                <div class="text-xs text-primary-200">
                    Version 2.0
                </div>
            </div>
        </div>
    </footer>

    <!-- Loading Modal -->
    <div id="loadingModal" class="hidden fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 flex items-center justify-center">
        <div class="bg-white rounded-2xl p-8 shadow-2xl flex flex-col items-center gap-4">
            <div class="w-12 h-12 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin"></div>
            <p class="text-slate-700 font-medium">Enregistrement en cours...</p>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="fixed bottom-6 right-6 z-50 flex flex-col gap-3"></div>

    <!-- Scripts -->
    <script src="js/dental-chart.js"></script>
    <script src="js/file-upload.js"></script>
    <script src="js/screenshot.js"></script>
    <script type="module" src="js/firebase-config.js"></script>
    <script type="module" src="js/app.js"></script>
</body>
</html>
